<!DOCTYPE html><html lang="en-US"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="og:url" content="https://atomicnicos.me/post/2022/2022_01_30+knight-ctf-2022-reverse-writeups">
  <meta name="og:locale" content="en_us">
  <meta name="og:site_name" content="https://atomicnicos.me">
  <meta name="og:title" content="Dissecting the KnightCTF Reverse Engineering challenges! | AtomicNicos's Blog">
  <meta name="og:description" content="KnightCTF! A write-up on solving challenges from the &quot;Reverse Engineering&quot; category.">
  <meta name="og:image" content="https://atomicnicos.me/assets/images/cover.jpg">
  <meta name="description" content="KnightCTF! A write-up on solving challenges from the &quot;Reverse Engineering&quot; category.">
  <meta name="keywords" content="atomicnicos, osint, infosec, security, cybersec, cybersecurity, KnightCTF, ctf, challenge, reverse">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="https://atomicnicos.me/post/2022/2022_01_30+knight-ctf-2022-reverse-writeups">
  <meta name="twitter:image" content="https://atomicnicos.me/assets/images/cover.jpg">
  <meta name="twitter:label1" content="Written By">
  <meta name="twitter:data1" content="Nicolas Boeckh">
  <meta name="twitter:site" content="@AtomicNicos">
  <meta name="twitter:creator" content="@AtomicNicos">
  <meta name="twitter:image:width" content="1280">
  <meta name="twitter:image:height" content="720">
  <title>Dissecting the KnightCTF Reverse Engineering challenges! | AtomicNicos's Blog</title>
  <base href="/">
  <link rel="icon" type="image/x-icon" href="favicon.png">
  <script data-goatcounter="https://atomicnicos.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>
  <script src="https://kit.fontawesome.com/88cfc0e7e2.js" integrity="sha384-sX7kjQzLM8MFrzb6uyCnPsr+HRySaCE3/aRRrej3bbJ3kjm5GXmGWM1oYePcm1BW" crossorigin="anonymous"></script>
<link rel="stylesheet" href="styles.36a6891608ed9ce2.css"><style ng-transition="atomicnicos-me">.sidebar[_ngcontent-sc68]{position:relative;float:left;width:30%;padding:0 10px;overflow-y:visible}</style><style ng-transition="atomicnicos-me">footer[_ngcontent-sc17]{border-top:1px dashed #b5e853}</style><style ng-transition="atomicnicos-me">.text-decoration-underline[_ngcontent-sc65]{text-decoration:underline}</style><style ng-transition="atomicnicos-me">div[_ngcontent-sc66] > a[_ngcontent-sc66] > span[_ngcontent-sc66]{margin:.25rem;padding:.5rem;background-color:#2e2e2e;border-radius:.25rem;font-size:smaller}div[_ngcontent-sc66] > a[_ngcontent-sc66]{margin:.5rem 0}</style><style ng-transition="atomicnicos-me">p[_ngcontent-sc19]{font-size:smaller;color:#aaa}</style><style ng-transition="atomicnicos-me">p[_ngcontent-sc20]{font-size:smaller;color:#aaa}span[_ngcontent-sc20]{margin:.375rem;padding:.5rem;border-radius:.5rem;background-color:#484848}</style></head>
<body>
  <app-root ng-version="14.0.1"><div class="h-100 w-100 d-flex flex-column justify-content-between"><app-header class="align-self-stretch"><header class="mb-3"><div class="container"><a id="a-title" href="/"><h1 class="ml-2">atomicnicosâ€‹@1337m4ch1n3</h1></a><h2>AtomicNicos's Blog at the end of the universe.</h2><nav><ul class="nav-lists d-flex flex-row flex-wrap"><li class="paths align-middle my-auto justify-content-center">Paths:</li><li class="nav-elements"><a href="/whoami">~$ whoami</a></li><li class="nav-elements"><a href="/posts">~$ ls -la ./posts</a></li></ul></nav></div></header></app-header><app-main-body class="align-self-stretch align-items-stretch mb-auto" _nghost-sc68=""><div _ngcontent-sc68="" class="container main-page"><div _ngcontent-sc68="" class="main-content"><router-outlet></router-outlet><app-knightctf2022-reverse _nghost-sc28=""><app-post-body _ngcontent-sc28=""><h1>~$ Dissecting the KnightCTF Reverse Engineering challenges!</h1><app-when _nghost-sc19=""><p _ngcontent-sc19="">Posted on Jan. 30th, 2022. <!----></p></app-when><app-tag-viewer _nghost-sc20=""><p _ngcontent-sc20=""><strong _ngcontent-sc20="">Tags:</strong><span _ngcontent-sc20=""><a _ngcontent-sc20="" href="/tags/CTF">CTF</a></span><span _ngcontent-sc20=""><a _ngcontent-sc20="" href="/tags/Write-Up">Write-Up</a></span><!----></p><!----><br _ngcontent-sc20=""></app-tag-viewer><div><h4 _ngcontent-sc28="">Write-ups</h4><ul _ngcontent-sc28=""><li _ngcontent-sc28=""><a _ngcontent-sc28="" routerlink="." fragment="baby-shark" class="no-underline" href="/post/2022/2022_01_30%2Bknight-ctf-2022-reverse-writeups#baby-shark">Baby Shark</a></li><li _ngcontent-sc28=""><a _ngcontent-sc28="" routerlink="." fragment="droid-flag" class="no-underline" href="/post/2022/2022_01_30%2Bknight-ctf-2022-reverse-writeups#droid-flag">Droid Flag</a></li></ul><hr _ngcontent-sc28=""><h4 _ngcontent-sc28="" id="baby-shark">Baby Shark (50 points)</h4><p _ngcontent-sc28="" style="color: lime;">During my holiday in Bahamas, I met a baby shark. The shark wanted to sing me something but couldn't. Can you sing that for me?</p><p _ngcontent-sc28="" style="color: lime;">Flag Format: KCTF{SomE_T3xT_h3r3}</p><br _ngcontent-sc28=""><p _ngcontent-sc28="">Once the JAR is downloaded, go to <a _ngcontent-sc28="" href="httpd://javadecompilers.com">javadecompilers.com</a>, and upload it there.</p><p _ngcontent-sc28="">We obtain a ZIP which we then unpack, revealing the following file structure:</p><div _ngcontent-sc28="" class="d-flex flex-row align-items-center media-container"><div _ngcontent-sc28="" class="d-flex"><img _ngcontent-sc28="" src="assets/images/2022/220130-rev-challenges/tree.png" alt="File tree"></div></div><p _ngcontent-sc28="">We can see a few interesting Java files, which we'll get into quickly.</p><p _ngcontent-sc28="">The first is <code _ngcontent-sc28="">Flag.java</code>, it is not very interesting:</p><div _ngcontent-sc28="" class="d-flex flex-row align-items-center media-container"><div _ngcontent-sc28="" class="d-flex"><img _ngcontent-sc28="" src="assets/images/2022/220130-rev-challenges/FlagCode.png" alt="A few false flags."></div></div><p _ngcontent-sc28="">In <code _ngcontent-sc28="">Strings.java</code> we can see what resembles strings that are Base64 encoded:</p><div _ngcontent-sc28="" class="d-flex flex-row align-items-center media-container"><div _ngcontent-sc28="" class="d-flex"><img _ngcontent-sc28="" src="assets/images/2022/220130-rev-challenges/StringsCode.png" alt="The various base64 codes"></div></div><p _ngcontent-sc28="">If we throw these in a Base64 decoder, the last gives us the flag: <code _ngcontent-sc28="">KCTF{7H15_W@5_345Y_R16H7?}</code></p><br _ngcontent-sc28=""><hr _ngcontent-sc28=""><h4 _ngcontent-sc28="" id="droid-flag">Droid Flag (100 points)</h4><p _ngcontent-sc28="">One needs to decompile the provided APK, and understand what the decompiled code does, to retrieve the flag.</p><p _ngcontent-sc28="">Once the ZIP is downloaded, extract the APK contained within, then go to <a _ngcontent-sc28="" href="httpd://javadecompilers.com">javadecompilers.com</a>, and upload it there.</p><p _ngcontent-sc28="">We obtain a ZIP which we then unpack, revealing the following file structure:</p><div _ngcontent-sc28="" class="d-flex flex-row align-items-center media-container"><div _ngcontent-sc28="" class="d-flex"><img _ngcontent-sc28="" src="assets/images/2022/220130-rev-challenges/droid-tree.png" alt="The various base64 codes"></div></div><p _ngcontent-sc28="">We can see a few interesting Java files, which we'll get into quickly.</p><p _ngcontent-sc28="">The first is <code _ngcontent-sc28="">MainActivity.java</code>, it contains a few interesting lines:</p><div _ngcontent-sc28="" class="d-flex flex-row align-items-center media-container"><div _ngcontent-sc28="" class="d-flex"><img _ngcontent-sc28="" src="assets/images/2022/220130-rev-challenges/MainActivityCode.png" alt="The various base64 codes"></div></div><p _ngcontent-sc28="">We can see that this code calls a number of functions in the <code _ngcontent-sc28="">StringHandler</code> class from the <code _ngcontent-sc28="">StringHandler.java</code> file, in the following order:</p><p _ngcontent-sc28=""><code _ngcontent-sc28="">$(S1){$(S3)_$(S2)_$(S4)}</code></p><div _ngcontent-sc28="" class="d-flex flex-row align-items-center media-container"><div _ngcontent-sc28="" class="d-flex"><img _ngcontent-sc28="" src="assets/images/2022/220130-rev-challenges/StringHandlerCode.png" alt="The various base64 codes"></div></div><ul _ngcontent-sc28=""><li _ngcontent-sc28=""><code _ngcontent-sc28="">S1</code> gets a value defined in class <code _ngcontent-sc28="">C074SR</code> where the identifier is <code _ngcontent-sc28="">f112s5</code></li><li _ngcontent-sc28=""><code _ngcontent-sc28="">S2</code> gets a value defined in class <code _ngcontent-sc28="">C074SR</code> where the identifier is <code _ngcontent-sc28="">f113s6</code></li><li _ngcontent-sc28=""><code _ngcontent-sc28="">S3</code> gets a value defined in class <code _ngcontent-sc28="">C074SR</code> where the identifier is <code _ngcontent-sc28="">f114s7</code></li><li _ngcontent-sc28=""><code _ngcontent-sc28="">S4</code> gets a value defined in class <code _ngcontent-sc28="">C074SR</code> where the identifier is <code _ngcontent-sc28="">f115s8</code></li></ul><p _ngcontent-sc28="">Those values are:</p><div _ngcontent-sc28="" class="d-flex flex-row align-items-center media-container"><div _ngcontent-sc28="" class="d-flex"><img _ngcontent-sc28="" src="assets/images/2022/220130-rev-challenges/C0754RCode.png" alt="The various base64 codes"></div></div><p _ngcontent-sc28="">We look for any identifier with those numbers (<code _ngcontent-sc28="">grep</code> is useful), and find some in <code _ngcontent-sc28="">public.xml</code>:</p><div _ngcontent-sc28="" class="d-flex flex-row align-items-center media-container"><div _ngcontent-sc28="" class="d-flex"><img _ngcontent-sc28="" src="assets/images/2022/220130-rev-challenges/PublicXML.png" alt="The various base64 codes"></div></div><p _ngcontent-sc28="">We then look for the names provided in <code _ngcontent-sc28="">strings.xml</code>:</p><div _ngcontent-sc28="" class="d-flex flex-row align-items-center media-container"><div _ngcontent-sc28="" class="d-flex"><img _ngcontent-sc28="" src="assets/images/2022/220130-rev-challenges/StringsXML.png" alt="The various base64 codes"></div></div><p _ngcontent-sc28="">In <code _ngcontent-sc28="">StringHandler.java</code> we see that the values for <code _ngcontent-sc28="">S2</code>, <code _ngcontent-sc28="">S3</code> and <code _ngcontent-sc28="">S4</code> are then reversed, which makes the final flag: <code _ngcontent-sc28="">$(S1){$(S3)_$(S2)_$(S4)}</code> -&gt; <code _ngcontent-sc28="">KCTF{aNdR01D_s1MpL3_r3V3rS3}</code>.</p></div></app-post-body></app-knightctf2022-reverse><!----><div _ngcontent-sc68=""><span _ngcontent-sc68=""></span><br _ngcontent-sc68=""></div></div><div _ngcontent-sc68="" class="sidebar"><app-sidebar _ngcontent-sc68=""><app-socials><h4>~$ Find me here</h4><div class="center d-flex flex-row justify-content-center flex-wrap"><div class="mx-2"><a target="_blank" href="https://twitter.com/AtomicNicos" rel="noopener"><em class="fab fa-twitter-square fa-2x"></em></a></div>â€‹ <div class="mx-2"><a target="_blank" href="https://linkedin.com/in/nicolas-boeckh" rel="noopener"><em class="fab fa-linkedin fa-2x"></em></a></div>â€‹ <div class="mx-2"><a target="_blank" href="https://github.com/AtomicNicos" rel="noopener"><em class="fab fa-github-square fa-2x"></em></a></div>â€‹ <div class="mx-2"><a target="_blank" href="https://gitlab.unige.ch/Nicolas.Boeckh" rel="noopener"><em class="fab fa-gitlab fa-2x"></em></a></div>â€‹
</div></app-socials><div class="separator my-4"></div><app-latest _nghost-sc65=""><h4 _ngcontent-sc65="">~$ Latest Posts</h4><div _ngcontent-sc65="" class="my-2"><p _ngcontent-sc65="" class="m-0"><span _ngcontent-sc65="" class="text-decoration-underline">30/01/2022:</span>&nbsp; <a _ngcontent-sc65="" class="no-underline" href="post/2022/2022_01_30+knight-ctf-2022-reverse-writeups">Dissecting the KnightCTF Reverse Engineering challenges!</a></p></div><div _ngcontent-sc65="" class="my-2"><p _ngcontent-sc65="" class="m-0"><span _ngcontent-sc65="" class="text-decoration-underline">30/01/2022:</span>&nbsp; <a _ngcontent-sc65="" class="no-underline" href="post/2022/2022_01_30+knight-ctf-2022-programming-writeups">Dissecting the KnightCTF Programming challenges!</a></p></div><div _ngcontent-sc65="" class="my-2"><p _ngcontent-sc65="" class="m-0"><span _ngcontent-sc65="" class="text-decoration-underline">30/01/2022:</span>&nbsp; <a _ngcontent-sc65="" class="no-underline" href="post/2022/2022_01_30+knight-ctf-2022-misc-writeups">Dissecting the KnightCTF Misc challenges!</a></p></div><div _ngcontent-sc65="" class="my-2"><p _ngcontent-sc65="" class="m-0"><span _ngcontent-sc65="" class="text-decoration-underline">30/01/2022:</span>&nbsp; <a _ngcontent-sc65="" class="no-underline" href="post/2022/2022_01_30+knight-ctf-2022-cryptography-writeups">Dissecting the KnightCTF Cryptography challenges!</a></p></div><div _ngcontent-sc65="" class="my-2"><p _ngcontent-sc65="" class="m-0"><span _ngcontent-sc65="" class="text-decoration-underline">29/01/2022:</span>&nbsp; <a _ngcontent-sc65="" class="no-underline" href="post/2022/2022_01_29+knight-ctf-2022-all-writeups">Participating in the Knight CTF!</a></p></div><div _ngcontent-sc65="" class="my-2"><p _ngcontent-sc65="" class="m-0"><span _ngcontent-sc65="" class="text-decoration-underline">25/11/2021:</span>&nbsp; <a _ngcontent-sc65="" class="no-underline" href="post/2021/2021_11_25+speaking-at-conint">Speaking about communities at conINT</a></p></div><div _ngcontent-sc65="" class="my-2"><p _ngcontent-sc65="" class="m-0"><span _ngcontent-sc65="" class="text-decoration-underline">15/11/2021:</span>&nbsp; <a _ngcontent-sc65="" class="no-underline" href="post/2021/2021_11_15+happy-birthday-to-this-blog">Happy birthday to this blog!</a></p></div><!----></app-latest><div class="separator my-4"></div><app-list-tag-count _nghost-sc66=""><h4 _ngcontent-sc66="">~$ Tags</h4><div _ngcontent-sc66="" class="d-flex flex-wrap"><a _ngcontent-sc66="" class="no-underline" href="/tags/CTF"><span _ngcontent-sc66="">CTF (14)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/Write-Up"><span _ngcontent-sc66="">Write-Up (11)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/Programming"><span _ngcontent-sc66="">Programming (3)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/Cryptography"><span _ngcontent-sc66="">Cryptography (2)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/Conference"><span _ngcontent-sc66="">Conference (7)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/Community"><span _ngcontent-sc66="">Community (7)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/OSINT"><span _ngcontent-sc66="">OSINT (5)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/Personal"><span _ngcontent-sc66="">Personal (7)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/Information Security"><span _ngcontent-sc66="">Information Security (17)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/Application Security"><span _ngcontent-sc66="">Application Security (1)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/Talks"><span _ngcontent-sc66="">Talks (6)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/Development"><span _ngcontent-sc66="">Development (4)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/Web"><span _ngcontent-sc66="">Web (3)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/Privacy"><span _ngcontent-sc66="">Privacy (4)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/Cyber Security"><span _ngcontent-sc66="">Cyber Security (1)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/IOT"><span _ngcontent-sc66="">IOT (4)</span></a><a _ngcontent-sc66="" class="no-underline" href="/tags/Media"><span _ngcontent-sc66="">Media (1)</span></a><!----></div></app-list-tag-count></app-sidebar></div></div></app-main-body><app-footer class="align-items-end" _nghost-sc17=""><footer _ngcontent-sc17="" class="py-4 mt-3 footer"><div _ngcontent-sc17="" class="container center"><a _ngcontent-sc17="" routerlink="/copyright" href="/copyright">Copyright CC-BY-SA</a> AtomicNicos 2020-2021<br _ngcontent-sc17=""> (<a _ngcontent-sc17="" routerlink="/privacy-policy" href="/privacy-policy">Privacy Policy</a>) </div></footer></app-footer></div></app-root>
<script src="runtime.aa9782e2667b2081.js" type="module"></script><script src="polyfills.f613b71439b4b262.js" type="module"></script><script src="scripts.1ce5666f0346345c.js" defer=""></script><script src="main.44e93ddb9b16742a.js" type="module"></script>


</body><!-- This page was prerendered with Angular Universal --></html>