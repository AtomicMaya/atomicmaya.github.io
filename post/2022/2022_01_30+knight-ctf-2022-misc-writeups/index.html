<!DOCTYPE html><html lang="en-US"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="og:url" content="https://atomicmaya.me/post/2022/2022_01_30+knight-ctf-2022-misc-writeups">
  <meta name="og:locale" content="en_us">
  <meta name="og:site_name" content="https://atomicmaya.me">
  <meta name="og:title" content="Dissecting the KnightCTF Misc challenges! | AtomicMaya's Blog">
  <meta name="og:description" content="KnightCTF! A write-up on solving challenges from the &quot;Misc&quot; category.">
  <meta name="og:image" content="https://atomicmaya.me/assets/images/2022/220130-knightctf-assets/logo.png">
  <meta name="description" content="KnightCTF! A write-up on solving challenges from the &quot;Misc&quot; category.">
  <meta name="keywords" content="atomicnicos, atomicmaya, osint, infosec, security, cybersec, cybersecurity, KnightCTF, ctf, challenge, misc">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="https://atomicmaya.me/post/2022/2022_01_30+knight-ctf-2022-misc-writeups">
  <meta name="twitter:image" content="https://atomicmaya.me/assets/images/2022/220130-knightctf-assets/logo.png">
  <meta name="twitter:label1" content="Written By">
  <meta name="twitter:data1" content="Maya Boeckh">
  <meta name="twitter:site" content="@AtomicMaya">
  <meta name="twitter:creator" content="@AtomicMaya">
  <meta name="twitter:image:width" content="1280">
  <meta name="twitter:image:height" content="720">
  <title>Dissecting the KnightCTF Misc challenges! | AtomicMaya's Blog</title>
  <base href="/">
  <link rel="icon" type="image/x-icon" href="favicon.png">
  <script data-goatcounter="https://atomicmaya.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>
  <script src="https://kit.fontawesome.com/88cfc0e7e2.js" integrity="sha384-sX7kjQzLM8MFrzb6uyCnPsr+HRySaCE3/aRRrej3bbJ3kjm5GXmGWM1oYePcm1BW" crossorigin="anonymous"></script>
  <!-- Github Pages hack to allow SPA refresh without receiving 404. -->
  <script>
    window.prerenderReady = false;
    (function () {
      // Retrieve the URL the user was trying to access when receiving the 404.
      var redirect = sessionStorage.redirect;
      // Remove the URL from sessionStorage.
      delete sessionStorage.redirect;
      // Check if we actually need to redirect.
      if (redirect && redirect != location.href) {
        // We need to redirect to the URL the user was trying to access.
        history.replaceState(null, null, redirect);
      }
    })();
  </script>
  <!-- /Github Pages hack. -->
<link rel="stylesheet" href="styles.b420e920c9dbafeb.css"><style ng-transition="atomicmaya-me">.sidebar[_ngcontent-sc72]{position:relative;float:left;width:30%;padding:0 10px;overflow-y:visible}</style><style ng-transition="atomicmaya-me">footer[_ngcontent-sc18]{border-top:1px dashed #b5e853}</style><style ng-transition="atomicmaya-me">.text-decoration-underline[_ngcontent-sc69]{text-decoration:underline}</style><style ng-transition="atomicmaya-me">div[_ngcontent-sc70] > a[_ngcontent-sc70] > span[_ngcontent-sc70]{margin:.25rem;padding:.5rem;background-color:#2e2e2e;border-radius:.25rem;font-size:smaller}div[_ngcontent-sc70] > a[_ngcontent-sc70]{margin:.5rem 0}</style><style ng-transition="atomicmaya-me">p[_ngcontent-sc20]{font-size:smaller;color:#aaa}</style><style ng-transition="atomicmaya-me">p[_ngcontent-sc21]{font-size:smaller;color:#aaa;display:flex;margin-bottom:0;flex-wrap:wrap;padding:0;align-items:center}span[_ngcontent-sc21]{margin:.1rem .2rem;padding:.5rem;border-radius:.5rem;background-color:#484848}</style></head>
<body>
  <app-root ng-version="14.2.1"><div class="h-100 w-100 d-flex flex-column justify-content-between"><app-header class="align-self-stretch"><header class="mb-3"><div class="container"><a id="a-title" href="/"><h1 class="ms-2">atomicmaya​@1337m4ch1n3</h1></a><h2>AtomicMaya's Blog at the end of the universe.</h2><nav><ul class="nav-lists d-flex flex-row flex-wrap"><li class="paths align-middle my-auto justify-content-center">Paths:</li><li class="nav-elements"><a href="/whoami">~$ whoami</a></li><li class="nav-elements"><a href="/posts">~$ ls -la ./posts</a></li></ul></nav></div></header></app-header><app-main-body class="align-self-stretch align-items-stretch mb-auto" _nghost-sc72=""><div _ngcontent-sc72="" class="container main-page"><div _ngcontent-sc72="" class="main-content"><router-outlet></router-outlet><app-knightctf2022-misc><app-post-body><h1>~$ Dissecting the KnightCTF Misc challenges!</h1><app-when _nghost-sc20=""><p _ngcontent-sc20="">Posted on Jan. 30th, 2022. <!----></p></app-when><app-tag-viewer _nghost-sc21=""><p _ngcontent-sc21=""><strong _ngcontent-sc21="">Tags:</strong><span _ngcontent-sc21=""><a _ngcontent-sc21="" href="/tags/CTF">CTF</a></span><span _ngcontent-sc21=""><a _ngcontent-sc21="" href="/tags/Write-Up">Write-Up</a></span><!----></p><!----><br _ngcontent-sc21=""></app-tag-viewer><div><h4>Write-ups</h4><ul><li><a routerlink="." fragment="find-pass-code-2" class="no-underline" href="/post/2022/2022_01_30%2Bknight-ctf-2022-misc-writeups#find-pass-code-2">Find Pass Code - 2</a></li><li><a routerlink="." fragment="qr-code-from-the-future" class="no-underline" href="/post/2022/2022_01_30%2Bknight-ctf-2022-misc-writeups#qr-code-from-the-future">QR Code from the Future </a></li></ul><hr><h4 id="find-pass-code-2">Find Pass Code - 2 (150 points)</h4><p>This challenge was in the Web category, and relied on knowledge from the first challenge, mainly that it required the userr to append <code>?source</code> to the URL in order to print out the page's PHP source code.</p><p>This yields the following code:</p><div class="d-flex media-container"><markdown linenumbers="">
```php
require "flag.php";
$old_pass_codes = array("0e215962017", "0e730083352", "0e807097110", "0e840922711");
$old_pass_flag = false;
if (isset($_POST["pass_code"]) &amp;&amp; !is_array($_POST["pass_code"])) {
  foreach ($old_pass_codes as $old_pass_code) {
      if ($_POST["pass_code"] === $old_pass_code) {
          $old_pass_flag = true;
          break;
      }
  }
  if ($old_pass_flag) {
      echo "Sorry ! It's an old pass code.";
  } else if ($_POST["pass_code"] == md5($_POST["pass_code"])) {
      echo "KCTF Flag : {$flag}";
  } else {
      echo "Oh....My....God. You entered the wrong pass code.";
  }
}
if (isset($_GET["source"])) {
    print show_source(__FILE__);
}
```
    </markdown><!----></div><p>The first thing that struck me was the fact that it was comparing the passcode entered against its MD5 hash. However, with one-way hashing functions, that shouldn't be the case (<code>H(X) != X</code>).</p><p>However, we can see the <code>$old_pass_codes = array("0e215962017", "0e730083352", "0e807097110", "0e840922711");</code> array, which piqued my curiosity.</p><p>I'd remembered a story on Twitter about magic hashes, habitually preceded by the number 0e. (More here: <a href="https://www.whitehatsec.com/blog/magic-hashes/" target="_blank"><em class="fas fa-external-link-square-alt"></em> Magic Hashes</a>)</p><p>So I searched for an index of magic hashes until I found this website: <a href=" https://blog.csdn.net/u013512548/article/details/108213295" target="_blank"><em class="fas fa-external-link-square-alt"></em> 魔术hash on CSDN</a>.</p><div class="d-flex media-container"><img src="/assets/images/2022/220130-misc-challenges/MD5.png" alt="Magic MD5 hashes"></div><p>There were the 3 first hashes, so I took the fourth: 0e1137126905.</p><p>Enter that into the platform and we get the flag: <code>KCTF{ShOuD_wE_cOmPaRe_MD5_LiKe_ThAt__Be_SmArT}</code>.</p><hr><h4 id="qr-code-from-the-future">QR Code from the Future (100 points)</h4><div class="d-flex media-container"><img src="/assets/images/2022/220130-misc-challenges/challenge.gif" alt="GIF"></div><p>The first step is to de-animate the GIF. For this, we can go to EZGIF or use FFMPEG, like so:</p><div class="d-flex media-container"><markdown linenumbers="">
```bash
mkdir ./gif-images
ffmpeg.exe -i .\QR_Code_From_The_Future.gif -vsync 0 gif-images/%02d.png
```
    </markdown><!----></div><p>We can then use zbarimg (from the zbar-tools) to read the QR codes (zbarimg socket errrors can be expected and ignored):</p><div class="d-flex media-container"><markdown linenumbers="">
```sh
mkdir ./gif-images
ffmpeg.exe -i .\QR_Code_From_The_Future.gif -vsync 0 gif-images/%02d.png
```
    </markdown><!----></div><div class="d-flex media-container"><markdown linenumbers="">
```sh
find . -type f -wholename "*/gif-images/*.png" -exec sh -c 'RES=$(zbarimg $0 --raw -q); SUBSTR=$(echo $RES | cut -d':' -f 2); echo -n $SUBSTR;' { } \; &gt; gif_contents 2&gt;/dev/null
echo "" &gt;&gt; gif_contents
cat gif_contents
rm gif_contents
```
    </markdown><!----></div><p>FFMPEG takes the image provided with the GIF as input (<code>-i</code>), synchroneously (<code>-vsync 0</code>). It then saves it to <code>gif-images</code>, a directory that needs to exist.</p><p><code>%02</code> is so we don't have a flag out of order, it is just the number of leading zeros for that.</p><p>Find checks all files in the directory gif-images that are PNG files. We feed each of these images to zbarimg which produces a code, which we store, remove the QR-Code: segment preceding it and append it to gif_contents.</p></div></app-post-body></app-knightctf2022-misc><!----><div _ngcontent-sc72=""><span _ngcontent-sc72=""></span><br _ngcontent-sc72=""></div></div><div _ngcontent-sc72="" class="sidebar"><app-sidebar _ngcontent-sc72=""><app-socials><h4>~$ Find me here</h4><div class="center d-flex flex-row justify-content-center flex-wrap"><div class="mx-2"><a target="_blank" href="https://twitter.com/AtomicMaya_" rel="noopener"><em class="fab fa-twitter-square fa-2x"></em></a></div>​ ​ <div class="mx-2"><a target="_blank" href="https://github.com/AtomicMaya" rel="noopener"><em class="fab fa-github-square fa-2x"></em></a></div>​ ​ <div class="mx-2"><a target="_blank" href="https://keybase.io/atomicmaya" rel="noopener"><em class="fas fa-key fa-2x"></em></a></div>​ <div class="mx-2"><a target="_blank" href="https://tech.lgbt/@AtomicMaya" rel="noopener"><em class="fab fa-mastodon fa-2x"></em></a></div>​
</div></app-socials><div class="separator my-4"></div><app-latest _nghost-sc69=""><h4 _ngcontent-sc69="">~$ Latest Posts</h4><div _ngcontent-sc69="" class="my-2"><p _ngcontent-sc69="" class="m-0"><span _ngcontent-sc69="" class="text-decoration-underline">26/04/2022:</span>&nbsp; <a _ngcontent-sc69="" class="no-underline" href="post/2022/2022_04_26+running-the-digital-overdose-conference-again">Digital Overdose Conference 2: We're doing this again!</a></p></div><div _ngcontent-sc69="" class="my-2"><p _ngcontent-sc69="" class="m-0"><span _ngcontent-sc69="" class="text-decoration-underline">18/02/2022:</span>&nbsp; <a _ngcontent-sc69="" class="no-underline" href="post/2022/2022_02_18+Starting-a-new-job">I started a new job!</a></p></div><div _ngcontent-sc69="" class="my-2"><p _ngcontent-sc69="" class="m-0"><span _ngcontent-sc69="" class="text-decoration-underline">30/01/2022:</span>&nbsp; <a _ngcontent-sc69="" class="no-underline" href="post/2022/2022_01_30+knight-ctf-2022-reverse-writeups">Dissecting the KnightCTF Reverse Engineering challenges!</a></p></div><div _ngcontent-sc69="" class="my-2"><p _ngcontent-sc69="" class="m-0"><span _ngcontent-sc69="" class="text-decoration-underline">30/01/2022:</span>&nbsp; <a _ngcontent-sc69="" class="no-underline" href="post/2022/2022_01_30+knight-ctf-2022-programming-writeups">Dissecting the KnightCTF Programming challenges!</a></p></div><div _ngcontent-sc69="" class="my-2"><p _ngcontent-sc69="" class="m-0"><span _ngcontent-sc69="" class="text-decoration-underline">30/01/2022:</span>&nbsp; <a _ngcontent-sc69="" class="no-underline" href="post/2022/2022_01_30+knight-ctf-2022-misc-writeups">Dissecting the KnightCTF Misc challenges!</a></p></div><div _ngcontent-sc69="" class="my-2"><p _ngcontent-sc69="" class="m-0"><span _ngcontent-sc69="" class="text-decoration-underline">30/01/2022:</span>&nbsp; <a _ngcontent-sc69="" class="no-underline" href="post/2022/2022_01_30+knight-ctf-2022-cryptography-writeups">Dissecting the KnightCTF Cryptography challenges!</a></p></div><div _ngcontent-sc69="" class="my-2"><p _ngcontent-sc69="" class="m-0"><span _ngcontent-sc69="" class="text-decoration-underline">29/01/2022:</span>&nbsp; <a _ngcontent-sc69="" class="no-underline" href="post/2022/2022_01_29+knight-ctf-2022-all-writeups">Participating in KnightCTF!</a></p></div><div _ngcontent-sc69="" class="my-2"><p _ngcontent-sc69="" class="m-0"><span _ngcontent-sc69="" class="text-decoration-underline">15/01/2022:</span>&nbsp; <a _ngcontent-sc69="" class="no-underline" href="post/2022/2022_01_15+catching-covid">Catching COVID, detailing my experience.</a></p></div><div _ngcontent-sc69="" class="my-2"><p _ngcontent-sc69="" class="m-0"><span _ngcontent-sc69="" class="text-decoration-underline">25/11/2021:</span>&nbsp; <a _ngcontent-sc69="" class="no-underline" href="post/2021/2021_11_25+speaking-at-conint">Speaking about communities at conINT</a></p></div><!----></app-latest><div class="separator my-4"></div><app-list-tag-count _nghost-sc70=""><h4 _ngcontent-sc70="">~$ Tags</h4><div _ngcontent-sc70="" class="d-flex flex-wrap"><a _ngcontent-sc70="" class="no-underline" href="/tags/Conference"><span _ngcontent-sc70="">Conference (8)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/Community"><span _ngcontent-sc70="">Community (8)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/InfoSec"><span _ngcontent-sc70="">InfoSec (19)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/CyberSec"><span _ngcontent-sc70="">CyberSec (2)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/Volunteering"><span _ngcontent-sc70="">Volunteering (3)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/Professional"><span _ngcontent-sc70="">Professional (1)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/Programming"><span _ngcontent-sc70="">Programming (4)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/CTF"><span _ngcontent-sc70="">CTF (14)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/Write-Up"><span _ngcontent-sc70="">Write-Up (11)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/Cryptography"><span _ngcontent-sc70="">Cryptography (2)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/Personal"><span _ngcontent-sc70="">Personal (8)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/OSINT"><span _ngcontent-sc70="">OSINT (5)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/AppSec"><span _ngcontent-sc70="">AppSec (1)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/Talks"><span _ngcontent-sc70="">Talks (6)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/Development"><span _ngcontent-sc70="">Development (4)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/Web"><span _ngcontent-sc70="">Web (3)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/Privacy"><span _ngcontent-sc70="">Privacy (4)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/IOT"><span _ngcontent-sc70="">IOT (4)</span></a><a _ngcontent-sc70="" class="no-underline" href="/tags/Media"><span _ngcontent-sc70="">Media (1)</span></a><!----></div></app-list-tag-count></app-sidebar></div></div></app-main-body><app-footer class="align-items-end" _nghost-sc18=""><footer _ngcontent-sc18="" class="py-4 mt-3 footer"><div _ngcontent-sc18="" class="container center"><a _ngcontent-sc18="" routerlink="/copyright" href="/copyright">Copyright CC-BY-SA</a> AtomicMaya 2020-2022<br _ngcontent-sc18=""> (<a _ngcontent-sc18="" routerlink="/privacy-policy" href="/privacy-policy">Privacy Policy</a>) </div></footer></app-footer></div></app-root>
<script src="runtime.b329c1f9458d1158.js" type="module"></script><script src="polyfills.8a84757b170b8fe4.js" type="module"></script><script src="scripts.322bf2bede7b2054.js" defer=""></script><script src="main.a51b7ece9d982bc7.js" type="module"></script>


</body><!-- This page was prerendered with Angular Universal --></html>